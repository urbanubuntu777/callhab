# Инструкции по развертыванию CallHub на Render

## Подготовка проекта

Проект уже настроен для развертывания на Render. Все необходимые файлы созданы:

- `Dockerfile` - для сборки Docker образа
- `render.yaml` - конфигурация для Render
- `.dockerignore` - исключения для Docker
- Сервер настроен для раздачи статических файлов клиента

## Развертывание на Render

### Вариант 1: Через Render Dashboard (рекомендуется)

1. **Создайте аккаунт на [render.com](https://render.com)**

2. **Подключите GitHub репозиторий:**
   - Нажмите "New +" → "Web Service"
   - Выберите ваш GitHub репозиторий с проектом CallHub
   - Выберите ветку (обычно `main` или `master`)

3. **Настройте сервис:**
   - **Name**: `callhub` (или любое другое имя)
   - **Environment**: `Docker`
   - **Dockerfile Path**: `./Dockerfile`
   - **Plan**: `Free` (для начала)
   - **Region**: выберите ближайший к вам регион

4. **Переменные окружения:**
   - `NODE_ENV`: `production`
   - `PORT`: `5000` (Render автоматически установит этот порт)

5. **Нажмите "Create Web Service"**

### Вариант 2: Через render.yaml (Blueprint)

1. **Загрузите код в GitHub репозиторий**

2. **В Render Dashboard:**
   - Нажмите "New +" → "Blueprint"
   - Выберите ваш репозиторий
   - Render автоматически обнаружит `render.yaml` и создаст сервис

## После развертывания

1. **Дождитесь завершения сборки** (обычно 5-10 минут)

2. **Получите URL вашего приложения:**
   - Render предоставит URL вида: `https://callhub-xxxx.onrender.com`

3. **Проверьте работу:**
   - Откройте URL в браузере
   - Создайте комнату как Admin
   - Откройте ссылку в другом окне/браузере как User
   - Проверьте аудио и чат

## Особенности бесплатного плана Render

- **Sleep Mode**: Приложение "засыпает" после 15 минут неактивности
- **Cold Start**: Первый запрос после сна может занять 30-60 секунд
- **Ограничения**: 750 часов в месяц, 512MB RAM

## Обновление приложения

1. **Внесите изменения в код**
2. **Запушьте изменения в GitHub**
3. **Render автоматически пересоберет и развернет обновление**

## Мониторинг

- **Logs**: Просматривайте логи в Render Dashboard
- **Metrics**: Мониторьте использование ресурсов
- **Health Checks**: Render автоматически проверяет доступность

## Устранение неполадок

### Проблема: Приложение не запускается
- Проверьте логи в Render Dashboard
- Убедитесь, что все зависимости установлены
- Проверьте, что порт 5000 используется

### Проблема: WebSocket соединения не работают
- Убедитесь, что используется HTTPS (Render автоматически предоставляет SSL)
- Проверьте CORS настройки в сервере

### Проблема: Аудио не работает
- Проверьте, что браузер поддерживает WebRTC
- Убедитесь, что микрофон разрешен в браузере
- Проверьте STUN серверы в коде

## Переход на платный план

Если вам нужны:
- Отсутствие Sleep Mode
- Больше ресурсов
- Кастомный домен
- Приоритетная поддержка

Перейдите в настройки сервиса и выберите подходящий план.

## Дополнительные настройки

### Кастомный домен
1. В настройках сервиса добавьте ваш домен
2. Настройте DNS записи согласно инструкциям Render
3. Получите SSL сертификат (Render делает это автоматически)

### Переменные окружения
Можете добавить дополнительные переменные в настройках сервиса:
- `VITE_SERVER_URL` - если нужен кастомный URL сервера
- Другие переменные по необходимости
